<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MafiaSun | Ø¨Ø§Ø²ÛŒ Ø¢Ù†Ù„Ø§ÛŒÙ†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ Ø¨Ø§Ø²ÛŒ */
        #main-game-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://s8.uupload.ir/files/img_20260208_152349_053_b8yg.jpg') no-repeat center center fixed;
            background-size: cover;
            display: block;
        }
        
        /* ØµÙØ­Ù‡ ØªØ§Ù„Ø§Ø± Ø¯ÙˆØ³ØªØ§Ù†Ù‡ */
        #friendly-hall-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://s8.uupload.ir/files/img_20260208_174730_422_inei.jpg') no-repeat center center fixed;
            background-size: cover;
            display: none;
        }
        
        /* ØµÙØ­Ù‡ Ù„Ø§Ø¨ÛŒ */
        #lobby-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0c3461 0%, #0d47a1 100%);
            display: none;
            overflow: hidden;
        }
        
        /* Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø¯Ø± ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ */
        .profile-container {
            position: fixed;
            top: 20px;
            left: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(0, 0, 0, 0.7);
            padding: 12px 20px;
            border-radius: 25px;
            border: 2px solid #FF9800;
            cursor: pointer;
            z-index: 1000;
            transition: transform 0.3s;
        }
        
        .profile-container:hover {
            transform: scale(1.05);
            background: rgba(0, 0, 0, 0.8);
        }
        
        .profile-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 2px solid white;
            background: transparent;
        }
        
        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
        
        .profile-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .profile-name {
            color: white;
            font-family: sans-serif;
            font-size: 16px;
            font-weight: bold;
        }
        
        .profile-level {
            color: #FF9800;
            font-family: sans-serif;
            font-size: 14px;
            background: rgba(0, 0, 0, 0.5);
            padding: 2px 10px;
            border-radius: 10px;
            text-align: center;
        }
        
        /* Ù†ÙˆØ§Ø± Ø³ÛŒØ§Ù‡ Ù¾Ø§ÛŒÛŒÙ† ØµÙØ­Ù‡ (ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ) */
        .bottom-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 70px;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Ø¹Ú©Ø³ Ø®Ø§Ù†Ù‡ - Ø¨Ø¯ÙˆÙ† Ù‡ÛŒÚ† Ø­Ø§Ø´ÛŒÙ‡ ÛŒØ§ border */
        .house-img {
            width: 50px;
            height: 50px;
        }
        
        .house-img img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        /* Ø¯Ú©Ù…Ù‡ Ø´Ø±ÙˆØ¹ (ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ) */
        .start-button {
            position: fixed;
            bottom: 90px;
            left: 50%;
            transform: translateX(-50%);
            cursor: pointer;
            width: 180px;
            height: 180px;
        }
        
        .start-button img {
            width: 180px;
            height: 180px;
        }
        
        /* Ø¯Ú©Ù…Ù‡ Ø¶Ø±Ø¨Ø¯Ø± (ØµÙØ­Ù‡ ØªØ§Ù„Ø§Ø±) */
        .close-button {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            cursor: pointer;
            z-index: 1000;
        }
        
        .close-button img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        /* Ø¯Ú©Ù…Ù‡ Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ø¨ÛŒ (ØµÙØ­Ù‡ ØªØ§Ù„Ø§Ø±) */
        .create-lobby-btn {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 60px;
            cursor: pointer;
        }
        
        .create-lobby-btn img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        /* Ù„ÛŒØ³Øª Ù„Ø§Ø¨ÛŒâ€ŒÙ‡Ø§ÛŒ ØªØ§Ù„Ø§Ø± Ø¯ÙˆØ³ØªØ§Ù†Ù‡ */
        #lobbies-container {
            position: fixed;
            top: 100px;
            left: 20px;
            right: 20px;
            bottom: 180px;
            overflow-y: auto;
            display: none;
        }
        
        .lobby-card {
            background: linear-gradient(135deg, rgba(13, 71, 161, 0.9), rgba(21, 101, 192, 0.9));
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            border: 2px solid #FF9800;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .lobby-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }
        
        .lobby-info {
            flex: 1;
        }
        
        .lobby-name {
            color: white;
            font-family: sans-serif;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .lobby-details {
            color: #E0E0E0;
            font-family: sans-serif;
            font-size: 14px;
        }
        
        .lobby-players {
            color: #4CAF50;
            font-weight: bold;
        }
        
        .join-button {
            background: linear-gradient(135deg, #FF9800, #F57C00);
            color: black;
            border: none;
            padding: 8px 20px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            white-space: nowrap;
        }
        
        /* Ù…Ù†ÙˆÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ø¨ÛŒ */
        .lobby-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid #FF9800;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 400px;
            display: none;
            z-index: 10000;
        }
        
        /* Ø¯Ú©Ù…Ù‡ Ø¶Ø±Ø¨Ø¯Ø± Ù…Ù†Ùˆ */
        .modal-close {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 25px;
            height: 25px;
            cursor: pointer;
        }
        
        .modal-close img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: invert(1);
        }
        
        /* ÙØ±Ù… Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ø¨ÛŒ */
        .lobby-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .form-group label {
            color: white;
            font-family: sans-serif;
            font-size: 16px;
        }
        
        .form-group input {
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #FF9800;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
        }
        
        .checkbox-group {
            flex-direction: row;
            align-items: center;
            gap: 10px;
        }
        
        .checkbox-group input {
            width: 20px;
            height: 20px;
        }
        
        /* Ø¯Ú©Ù…Ù‡ Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ø¨ÛŒ Ø¯Ø± Ù…Ù†Ùˆ */
        .create-btn {
            background: linear-gradient(135deg, #FF9800, #F57C00);
            color: black;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 18px;
            cursor: pointer;
            margin-top: 10px;
            transition: transform 0.2s;
        }
        
        .create-btn:hover {
            transform: scale(1.05);
        }
        
        /* Ù…Ù†ÙˆÛŒ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ */
        .profile-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.97);
            border: 2px solid #FF9800;
            border-radius: 15px;
            padding: 0;
            width: 90%;
            max-width: 500px;
            display: none;
            z-index: 10001;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(255, 152, 0, 0.3);
        }
        
        .profile-modal-header {
            background: linear-gradient(135deg, #E65100, #BF360C);
            padding: 20px;
            text-align: center;
            border-bottom: 2px solid #FF9800;
            position: relative;
        }
        
        .profile-modal-title {
            color: white;
            font-family: sans-serif;
            font-size: 22px;
            font-weight: bold;
        }
        
        /* Ø¯Ú©Ù…Ù‡ Ø¶Ø±Ø¨Ø¯Ø± Ø¯Ø± Ù…Ù†ÙˆÛŒ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ */
        .profile-modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 30px;
            height: 30px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            border: 2px solid white;
        }
        
        .profile-modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }
        
        .profile-modal-close::before, .profile-modal-close::after {
            content: '';
            position: absolute;
            width: 18px;
            height: 2px;
            background: white;
        }
        
        .profile-modal-close::before {
            transform: rotate(45deg);
        }
        
        .profile-modal-close::after {
            transform: rotate(-45deg);
        }
        
        .profile-tabs {
            display: flex;
            background: rgba(255, 152, 0, 0.1);
            border-bottom: 1px solid #FF9800;
        }
        
        .profile-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            color: white;
            font-family: sans-serif;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }
        
        .profile-tab.active {
            background: rgba(255, 152, 0, 0.2);
            border-bottom: 3px solid #FF9800;
            color: #FF9800;
        }
        
        .profile-tab-content {
            padding: 25px;
            display: none;
            min-height: 300px;
        }
        
        .profile-tab-content.active {
            display: block;
        }
        
        /* ØªØ¨ Ø¢ÙˆØ§ØªØ§Ø± Ù…Ù† */
        .avatars-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        
        .avatar-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .avatar-item:hover {
            background: rgba(255, 152, 0, 0.1);
            transform: translateY(-5px);
        }
        
        .avatar-item.selected {
            border: 2px solid #FF9800;
            background: rgba(255, 152, 0, 0.15);
        }
        
        .avatar-preview {
            width: 100px;
            height: 100px;
            margin: 0 auto 15px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 3px solid white;
            background: transparent;
        }
        
        .avatar-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
        
        .avatar-name {
            color: white;
            font-family: sans-serif;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .avatar-select-btn {
            background: linear-gradient(135deg, #FF9800, #F57C00);
            color: black;
            border: none;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
            transition: transform 0.2s;
        }
        
        .avatar-select-btn:hover {
            transform: scale(1.05);
        }
        
        /* ØªØ¨ Ø®Ø±ÛŒØ¯ Ø¢ÙˆØ§ØªØ§Ø± */
        .coming-soon {
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-family: sans-serif;
            font-size: 20px;
            margin-top: 100px;
        }
        
        /* Ù†ÙˆØ§Ø± ØªÛŒØ±Ù‡ ØªÛŒØ±Ù‡ Ù¾Ø§ÛŒÛŒÙ† Ø¯Ø± ØµÙØ­Ù‡ Ù„Ø§Ø¨ÛŒ */
        .dark-bottom-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 90px;
            background: rgba(5, 15, 30, 0.95);
            border-top: 2px solid #E65100;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 10;
        }
        
        /* Ø¯Ø§ÛŒØ±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† */
        .players-container {
            position: fixed;
            bottom: 110px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            z-index: 5;
            padding: 0 20px;
        }
        
        /* Ø³Ø§Ø®ØªØ§Ø± Ø¯Ùˆ Ø³ØªÙˆÙ†ÛŒ Ø¨Ø±Ø§ÛŒ Ø¯Ø§ÛŒØ±Ù‡â€ŒÙ‡Ø§ */
        .circles-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px 120px;
            width: 100%;
            max-width: 600px;
        }
        
        /* Ø¯Ø§ÛŒØ±Ù‡ Ø¨Ø§Ø²ÛŒÚ©Ù† */
        .player-circle {
            width: 85px;
            height: 85px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }
        
        /* Ø¢ÙˆØ§ØªØ§Ø± Ø¨Ø²Ø±Ú¯ Ø¯Ø§Ø®Ù„ Ø¯Ø§ÛŒØ±Ù‡ */
        .player-avatar {
            width: 85px;
            height: 85px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 3px solid #E65100;
            background: linear-gradient(135deg, #0c3461, #0d47a1);
        }
        
        .player-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
        
        /* Ø´Ù…Ø§Ø±Ù‡ Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¯Ø± Ú©Ù†Ø§Ø± Ø¯Ø§ÛŒØ±Ù‡ */
        .player-number {
            position: absolute;
            top: -5px;
            right: -10px;
            background: #E65100;
            color: white;
            font-family: sans-serif;
            font-size: 14px;
            font-weight: bold;
            padding: 4px 8px;
            border-radius: 50%;
            min-width: 28px;
            height: 28px;
            text-align: center;
            z-index: 10;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        /* Ø³ØªÙˆÙ† Ø³Ù…Øª Ø±Ø§Ø³Øª */
        .player-circle:nth-child(odd) {
            justify-self: end;
            margin-right: 10px;
        }
        
        /* Ø³ØªÙˆÙ† Ø³Ù…Øª Ú†Ù¾ */
        .player-circle:nth-child(even) {
            justify-self: start;
            margin-left: 10px;
        }
        
        /* Ø§Ø³Ù… Ø¨Ø§Ø²ÛŒÚ©Ù† Ø²ÛŒØ± Ø¯Ø§ÛŒØ±Ù‡ */
        .player-name {
            font-size: 12px;
            text-align: center;
            max-width: 100px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            color: white;
            font-family: sans-serif;
            font-weight: bold;
            background: rgba(0, 0, 0, 0.4);
            padding: 4px 10px;
            border-radius: 10px;
            margin-top: 8px;
        }
        
        /* Ø¢ÛŒÚ©ÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ú©Ù†Ø§Ø± Ø¯Ø§ÛŒØ±Ù‡ */
        .player-icons {
            position: absolute;
            top: -5px;
            left: -10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            z-index: 10;
        }
        
        .player-icon {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            animation: fadeIn 0.3s ease;
        }
        
        .like-icon {
            background: #4CAF50;
            color: white;
        }
        
        .dislike-icon {
            background: #F44336;
            color: white;
        }
        
        .mic-icon {
            background: #2196F3;
            color: white;
            animation: pulse 2s infinite;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(33, 150, 243, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(33, 150, 243, 0); }
            100% { box-shadow: 0 0 0 0 rgba(33, 150, 243, 0); }
        }
        
        .like-icon.fade-out {
            animation: fadeOut 0.5s ease forwards;
        }
        
        @keyframes fadeOut {
            from { opacity: 1; transform: scale(1); }
            to { opacity: 0; transform: scale(0.5); }
        }
        
        /* ÙˆØ¶Ø¹ÛŒØª Ø¢Ù†Ù„Ø§ÛŒÙ† */
        .online-status {
            position: absolute;
            bottom: 5px;
            right: 5px;
            width: 12px;
            height: 12px;
            background: #4CAF50;
            border-radius: 50%;
            border: 2px solid white;
            z-index: 10;
        }
        
        /* Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ Ø¯Ø± Ù†ÙˆØ§Ø± Ù¾Ø§ÛŒÛŒÙ† */
        .control-buttons {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .control-btn {
            width: 70px;
            height: 70px;
            cursor: pointer;
            transition: transform 0.2s;
            background: transparent;
            border: none;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .control-btn img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: brightness(1);
        }
        
        /* Ø¯Ú©Ù…Ù‡ Ù…ÛŒÚ©Ø±ÙˆÙÙˆÙ† Ø·Ø±Ø§Ø­ÛŒ Ø¬Ø¯ÛŒØ¯ Ùˆ Ø®ÙˆØ´Ú¯Ù„ */
        .mic-btn {
            background: linear-gradient(135deg, #666, #444);
            border-radius: 50%;
            width: 70px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid #777;
        }
        
        .mic-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }
        
        .mic-btn.active {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            border-color: #64B5F6;
            box-shadow: 0 4px 20px rgba(33, 150, 243, 0.5);
        }
        
        .mic-btn.active:hover {
            box-shadow: 0 6px 25px rgba(33, 150, 243, 0.6);
        }
        
        .mic-icon-design {
            position: relative;
            width: 35px;
            height: 35px;
            transition: all 0.3s ease;
        }
        
        .mic-base {
            position: absolute;
            bottom: 2px;
            left: 50%;
            transform: translateX(-50%);
            width: 18px;
            height: 10px;
            background: #FFF;
            border-radius: 3px;
            transition: all 0.3s ease;
        }
        
        .mic-stem {
            position: absolute;
            bottom: 11px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 15px;
            background: #FFF;
            border-radius: 2px;
            transition: all 0.3s ease;
        }
        
        .mic-head {
            position: absolute;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
            width: 22px;
            height: 22px;
            background: #FFF;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .mic-head::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 14px;
            height: 14px;
            background: #666;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .mic-btn.active .mic-base,
        .mic-btn.active .mic-stem,
        .mic-btn.active .mic-head {
            background: #FFF;
        }
        
        .mic-btn.active .mic-head::before {
            background: #2196F3;
        }
        
        .mic-off {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(45deg);
            width: 30px;
            height: 4px;
            background: #F44336;
            border-radius: 2px;
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .mic-btn:not(.active) .mic-off {
            opacity: 1;
            background: #F44336;
        }
        
        .mic-btn:not(.active) .mic-base,
        .mic-btn:not(.active) .mic-stem,
        .mic-btn:not(.active) .mic-head {
            background: #AAA;
        }
        
        .mic-btn:not(.active) .mic-head::before {
            background: #777;
        }
        
        /* Ø¯Ú©Ù…Ù‡ Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ Ø¯Ø± Ø³Ù…Øª Ú†Ù¾ */
        .start-game-btn {
            position: fixed;
            bottom: 35px;
            left: 25px;
            width: 100px;
            height: 100px;
            cursor: pointer;
            transition: transform 0.2s;
            z-index: 11;
        }
        
        .start-game-btn:hover {
            transform: scale(1.05);
        }
        
        .start-game-btn img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5));
        }
        
        /* Ù†ÙˆØ§Ø± Ø¨Ø§Ù„Ø§ÛŒ Ù„Ø§Ø¨ÛŒ */
        .lobby-top-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 60px;
            background: linear-gradient(135deg, #E65100, #BF360C);
            border-bottom: 2px solid #FF9800;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 15px;
            z-index: 1000;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        }
        
        .lobby-title {
            color: white;
            font-family: sans-serif;
            font-size: 20px;
            font-weight: bold;
            text-align: center;
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        /* Ø¶Ø±Ø¨Ø¯Ø± Ø¨Ø³ØªÙ† */
        .lobby-close {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 30px;
            height: 30px;
            cursor: pointer;
            z-index: 1001;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            border: 2px solid white;
        }
        
        .lobby-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }
        
        .lobby-close::before, .lobby-close::after {
            content: '';
            position: absolute;
            width: 18px;
            height: 2px;
            background: white;
        }
        
        .lobby-close::before {
            transform: rotate(45deg);
        }
        
        .lobby-close::after {
            transform: rotate(-45deg);
        }
        
        /* Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ø§Ø³Ú©Ø±ÙˆÙ„Ø¨Ø§Ø± */
        body {
            overflow: hidden;
        }
        
        /* Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø±Ø§ÛŒ Ø§Ø³Ú©Ø±ÙˆÙ„Ø¨Ø§Ø± Ø¯Ø± ØªØ§Ù„Ø§Ø± */
        #lobbies-container::-webkit-scrollbar {
            width: 8px;
        }
        
        #lobbies-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }
        
        #lobbies-container::-webkit-scrollbar-thumb {
            background: #FF9800;
            border-radius: 4px;
        }
        
        .empty-state {
            text-align: center;
            color: rgba(255, 255, 255, 0.7);
            font-family: sans-serif;
            font-size: 18px;
            margin-top: 50px;
        }
        
        /* Ø¢ÙˆØ§ØªØ§Ø± Ø®Ø§Ù„ÛŒ */
        .empty-avatar {
            font-size: 32px;
            color: rgba(255, 255, 255, 0.5);
        }
        
        /* ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø± */
        .name-input-container {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .name-input-title {
            color: white;
            font-family: sans-serif;
            margin-bottom: 15px;
            font-size: 16px;
        }
        
        .current-name {
            color: #FF9800;
            font-weight: bold;
        }
        
        .name-form {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .name-input {
            flex: 1;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #FF9800;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
        }
        
        .name-submit-btn {
            background: linear-gradient(135deg, #FF9800, #F57C00);
            color: black;
            border: none;
            padding: 0 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            white-space: nowrap;
        }
        
        /* Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† ÙˆØ±ÙˆØ¯ Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯ */
        .player-joined-notification {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(76, 175, 80, 0.9);
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            font-family: sans-serif;
            font-size: 14px;
            font-weight: bold;
            z-index: 1002;
            animation: slideDown 0.5s ease, fadeOut 0.5s ease 2.5s forwards;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            border: 2px solid white;
        }
        
        @keyframes slideDown {
            from { top: 50px; opacity: 0; }
            to { top: 80px; opacity: 1; }
        }
        
        /* ÙˆØ¶Ø¹ÛŒØª Ø³Ø§Ø²Ù†Ø¯Ù‡ */
        .creator-badge {
            position: absolute;
            top: -5px;
            left: -5px;
            background: #FF9800;
            color: black;
            font-family: sans-serif;
            font-size: 10px;
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 10px;
            z-index: 11;
            border: 1px solid white;
        }
        
        /* ÙˆØ¶Ø¹ÛŒØª Ù…ÛŒÚ©Ø±ÙˆÙÙˆÙ† Ø¯Ø± Ø¯Ø§ÛŒØ±Ù‡ */
        .player-mic-status {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 20px;
            height: 20px;
            background: #2196F3;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: white;
            z-index: 11;
            border: 1px solid white;
        }
        
        /* Ú†Øª Ù„Ø§Ø¨ÛŒ */
        .chat-container {
            position: fixed;
            top: 70px;
            right: 20px;
            width: 300px;
            height: 300px;
            background: rgba(0, 0, 0, 0.85);
            border: 2px solid #FF9800;
            border-radius: 10px;
            display: none;
            flex-direction: column;
            z-index: 1000;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        
        .chat-header {
            background: linear-gradient(135deg, #E65100, #BF360C);
            padding: 10px;
            border-radius: 8px 8px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chat-title {
            color: white;
            font-family: sans-serif;
            font-weight: bold;
        }
        
        .chat-close {
            color: white;
            cursor: pointer;
            font-size: 20px;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .message {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 12px;
            border-radius: 10px;
            max-width: 85%;
        }
        
        .message.sent {
            align-self: flex-end;
            background: rgba(33, 150, 243, 0.3);
            border: 1px solid #2196F3;
        }
        
        .message.received {
            align-self: flex-start;
            background: rgba(255, 152, 0, 0.3);
            border: 1px solid #FF9800;
        }
        
        .message-sender {
            font-weight: bold;
            color: #FF9800;
            font-size: 12px;
            margin-bottom: 2px;
        }
        
        .message-text {
            color: white;
            font-size: 14px;
        }
        
        .chat-input-container {
            display: flex;
            padding: 10px;
            gap: 10px;
        }
        
        .chat-input {
            flex: 1;
            padding: 8px 12px;
            border-radius: 20px;
            border: 1px solid #FF9800;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
        }
        
        .chat-send-btn {
            background: linear-gradient(135deg, #FF9800, #F57C00);
            color: black;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
        }
        
        /* Ø¯Ú©Ù…Ù‡ Ú†Øª */
        .chat-toggle-btn {
            position: fixed;
            top: 70px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #FF9800, #F57C00);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 999;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            border: 2px solid white;
        }
        
        .chat-toggle-btn img {
            width: 24px;
            height: 24px;
            filter: brightness(0) invert(1);
        }
        
        /* Ù„ÙˆØ¯ÛŒÙ†Ú¯ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            color: white;
            font-family: sans-serif;
            gap: 20px;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #FF9800;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Ù¾ÛŒØ§Ù… Ø®Ø·Ø§ */
        .error-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(244, 67, 54, 0.9);
            color: white;
            padding: 20px 30px;
            border-radius: 10px;
            font-family: sans-serif;
            text-align: center;
            z-index: 10001;
            display: none;
        }
    </style>
</head>
<body>
    <!-- ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ Ø¨Ø§Ø²ÛŒ -->
    <div id="main-game-page">
        <!-- Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ú©Ø§Ø±Ø¨Ø± -->
        <div class="profile-container" onclick="openProfileModal()">
            <div class="profile-avatar" id="mainProfileAvatar">
                <!-- Ø¢ÙˆØ§ØªØ§Ø± Ú©Ø§Ø±Ø¨Ø± -->
            </div>
            <div class="profile-info">
                <div class="profile-name" id="mainProfileName">Ø¨Ø§Ø²ÛŒÚ©Ù†</div>
                <div class="profile-level">Ø³Ø·Ø­ 1</div>
            </div>
        </div>
        
        <!-- Ø¯Ú©Ù…Ù‡ Ø´Ø±ÙˆØ¹ -->
        <div class="start-button" onclick="openFriendlyHall()">
            <img src="https://s8.uupload.ir/files/inshot_20260208_175011014_dlkk.png" alt="Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ">
        </div>
        
        <!-- Ù†ÙˆØ§Ø± Ø³ÛŒØ§Ù‡ Ù¾Ø§ÛŒÛŒÙ† ØµÙØ­Ù‡ -->
        <div class="bottom-bar">
            <div class="house-img">
                <img src="https://s8.uupload.ir/files/inshot_20260208_175045137_2eb2.png" alt="Ø®Ø§Ù†Ù‡">
            </div>
        </div>
    </div>
    
    <!-- ØµÙØ­Ù‡ ØªØ§Ù„Ø§Ø± Ø¯ÙˆØ³ØªØ§Ù†Ù‡ -->
    <div id="friendly-hall-page">
        <!-- Ø¯Ú©Ù…Ù‡ Ø¶Ø±Ø¨Ø¯Ø± Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø²Ú¯Ø´Øª -->
        <div class="close-button" onclick="goBackToGame()">
            <img src="https://s8.uupload.ir/files/inshot_20260208_175500060_irk3.png" alt="Ø¨Ø§Ø²Ú¯Ø´Øª">
        </div>
        
        <!-- Ø¯Ú©Ù…Ù‡ Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ø¨ÛŒ -->
        <div class="create-lobby-btn" onclick="openLobbyModal()">
            <img src="https://s8.uupload.ir/files/inshot_20260208_184908314_wlkw.png" alt="Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ø¨ÛŒ">
        </div>
        
        <!-- Ù„ÛŒØ³Øª Ù„Ø§Ø¨ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ -->
        <div id="lobbies-container">
            <!-- Ù„Ø§Ø¨ÛŒâ€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø¯ÛŒÙ†Ø§Ù…ÛŒÚ© Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
        </div>
    </div>
    
    <!-- ØµÙØ­Ù‡ Ù„Ø§Ø¨ÛŒ -->
    <div id="lobby-page">
        <!-- Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† ÙˆØ±ÙˆØ¯ Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯ -->
        <div id="playerJoinedNotification" class="player-joined-notification" style="display: none;"></div>
        
        <!-- Ø¯Ú©Ù…Ù‡ Ú†Øª -->
        <div class="chat-toggle-btn" onclick="toggleChat()">
            <img src="https://s8.uupload.ir/files/chat_icon_8wef.png" alt="Ú†Øª">
        </div>
        
        <!-- Ù¾Ù†Ø¬Ø±Ù‡ Ú†Øª -->
        <div class="chat-container" id="chatContainer">
            <div class="chat-header">
                <div class="chat-title">ğŸ’¬ Ú†Øª Ù„Ø§Ø¨ÛŒ</div>
                <div class="chat-close" onclick="toggleChat()">Ã—</div>
            </div>
            <div class="chat-messages" id="chatMessages">
                <!-- Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
            </div>
            <div class="chat-input-container">
                <input type="text" class="chat-input" id="chatInput" placeholder="Ù¾ÛŒØ§Ù… Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯...">
                <button class="chat-send-btn" onclick="sendChatMessage()">Ø§Ø±Ø³Ø§Ù„</button>
            </div>
        </div>
        
        <!-- Ù†ÙˆØ§Ø± Ø¨Ø§Ù„Ø§ÛŒ Ù„Ø§Ø¨ÛŒ -->
        <div class="lobby-top-bar">
            <div class="lobby-title" id="lobbyTitle">Ù†Ø§Ù… Ù„Ø§Ø¨ÛŒ</div>
            <!-- Ø¶Ø±Ø¨Ø¯Ø± Ø¨Ø³ØªÙ† -->
            <div class="lobby-close" onclick="closeLobby()"></div>
        </div>
        
        <!-- Ø¯Ø§ÛŒØ±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† -->
        <div class="players-container">
            <div class="circles-columns" id="playersGrid">
                <!-- Ø¯Ø§ÛŒØ±Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø¯ÛŒÙ†Ø§Ù…ÛŒÚ© Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
            </div>
        </div>
        
        <!-- Ù†ÙˆØ§Ø± ØªÛŒØ±Ù‡ ØªÛŒØ±Ù‡ Ù¾Ø§ÛŒÛŒÙ† Ø¨Ø§ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ -->
        <div class="dark-bottom-bar">
            <!-- Ø¯Ú©Ù…Ù‡ Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ Ø¯Ø± Ø³Ù…Øª Ú†Ù¾ -->
            <div class="start-game-btn" onclick="startGame()">
                <img src="https://s8.uupload.ir/files/inshot_20260208_202015303_bu6y.png" alt="Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ">
            </div>
            
            <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ Ø³Ù…Øª Ø±Ø§Ø³Øª -->
            <div class="control-buttons">
                <button class="control-btn like-btn" onclick="toggleLike()">
                    <img src="https://s8.uupload.ir/files/inshot_20260208_174410945_l9ef.png" alt="Ù„Ø§ÛŒÚ©">
                </button>
                <button class="control-btn dislike-btn" onclick="toggleDislike()">
                    <img src="https://s8.uupload.ir/files/inshot_20260208_174516362_oz8n.png" alt="Ø¯ÛŒØ³Ù„Ø§ÛŒÚ©">
                </button>
                <div class="mic-btn" id="micButton" onclick="toggleMic()">
                    <div class="mic-icon-design">
                        <div class="mic-base"></div>
                        <div class="mic-stem"></div>
                        <div class="mic-head"></div>
                        <div class="mic-off"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Ù…Ù†ÙˆÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ø¨ÛŒ -->
    <div class="lobby-modal" id="lobbyModal">
        <!-- Ø¯Ú©Ù…Ù‡ Ø¶Ø±Ø¨Ø¯Ø± Ù…Ù†Ùˆ -->
        <div class="modal-close" onclick="closeLobbyModal()">
            <img src="https://s8.uupload.ir/files/inshot_20260208_175500060_irk3.png" alt="Ø¨Ø³ØªÙ†">
        </div>
        
        <!-- ÙØ±Ù… Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ø¨ÛŒ -->
        <form class="lobby-form" id="lobbyForm">
            <div class="form-group">
                <label for="lobbyName">Ø§Ø³Ù… Ù„Ø§Ø¨ÛŒ</label>
                <input type="text" id="lobbyName" placeholder="Ù…Ø«Ø§Ù„: Ù„Ø§Ø¨ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ" required>
            </div>
            
            <div class="form-group checkbox-group">
                <input type="checkbox" id="hasPassword" onclick="togglePasswordField()">
                <label for="hasPassword">Ù„Ø§Ø¨ÛŒ Ø±Ù…Ø²Ø¯Ø§Ø±</label>
            </div>
            
            <div class="form-group" id="passwordGroup" style="display: none;">
                <label for="lobbyPassword">Ø±Ù…Ø² Ù„Ø§Ø¨ÛŒ</label>
                <input type="password" id="lobbyPassword" placeholder="Ø±Ù…Ø² Ø¯Ù„Ø®ÙˆØ§Ù‡">
            </div>
            
            <div class="form-group">
                <label>Ù†Ù‚Ø´: ØªÚ©Ø§ÙˆØ± - Ø¸Ø±ÙÛŒØª: 10 Ù†ÙØ±</label>
            </div>
            
            <button type="button" class="create-btn" onclick="createLobby()">Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ø¨ÛŒ</button>
        </form>
    </div>
    
    <!-- Ù…Ù†ÙˆÛŒ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ -->
    <div class="profile-modal" id="profileModal">
        <div class="profile-modal-header">
            <div class="profile-modal-title">Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ú©Ø§Ø±Ø¨Ø±</div>
            <!-- Ø¶Ø±Ø¨Ø¯Ø± Ø¨Ø³ØªÙ† -->
            <div class="profile-modal-close" onclick="closeProfileModal()"></div>
        </div>
        
        <div class="profile-tabs">
            <div class="profile-tab active" onclick="switchProfileTab('avatars')">Ø¢ÙˆØ§ØªØ§Ø± Ù…Ù†</div>
            <div class="profile-tab" onclick="switchProfileTab('buy')">Ø®Ø±ÛŒØ¯ Ø¢ÙˆØ§ØªØ§Ø±</div>
        </div>
        
        <!-- ØªØ¨ Ø¢ÙˆØ§ØªØ§Ø± Ù…Ù† -->
        <div class="profile-tab-content active" id="avatarsTab">
            <h3 style="color: white; font-family: sans-serif; text-align: center; margin-bottom: 20px;">Ø¢ÙˆØ§ØªØ§Ø± Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</h3>
            
            <div class="avatars-container">
                <!-- Ø¢ÙˆØ§ØªØ§Ø± 1 -->
                <div class="avatar-item" id="avatar1" onclick="selectAvatar('avatar1')">
                    <div class="avatar-preview">
                        <img src="https://s8.uupload.ir/files/inshot_20260208_214035107_wkwk.png" alt="Ø¢ÙˆØ§ØªØ§Ø± 1">
                    </div>
                    <div class="avatar-name">Ø¢ÙˆØ§ØªØ§Ø± Ù…Ø±Ø¯</div>
                    <button class="avatar-select-btn" onclick="selectAvatar('avatar1'); event.stopPropagation();">Ø§Ù†ØªØ®Ø§Ø¨</button>
                </div>
                
                <!-- Ø¢ÙˆØ§ØªØ§Ø± 2 -->
                <div class="avatar-item" id="avatar2" onclick="selectAvatar('avatar2')">
                    <div class="avatar-preview">
                        <img src="https://s8.uupload.ir/files/inshot_20260208_214116629_6joe.png" alt="Ø¢ÙˆØ§ØªØ§Ø± 2">
                    </div>
                    <div class="avatar-name">Ø¢ÙˆØ§ØªØ§Ø± Ø²Ù†</div>
                    <button class="avatar-select-btn" onclick="selectAvatar('avatar2'); event.stopPropagation();">Ø§Ù†ØªØ®Ø§Ø¨</button>
                </div>
            </div>
            
            <!-- ØªÙ†Ø¸ÛŒÙ… Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø± -->
            <div class="name-input-container">
                <div class="name-input-title">
                    Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ ÙØ¹Ù„ÛŒ: <span class="current-name" id="currentUserName">Ø¨Ø§Ø²ÛŒÚ©Ù†</span>
                </div>
                <div class="name-form">
                    <input type="text" class="name-input" id="userNameInput" placeholder="Ù†Ø§Ù… Ø¬Ø¯ÛŒØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                    <button class="name-submit-btn" onclick="saveUserName()">ØªØºÛŒÛŒØ±</button>
                </div>
            </div>
        </div>
        
        <!-- ØªØ¨ Ø®Ø±ÛŒØ¯ Ø¢ÙˆØ§ØªØ§Ø± -->
        <div class="profile-tab-content" id="buyTab">
            <div class="coming-soon">Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ...</div>
        </div>
    </div>
    
    <!-- Ù„ÙˆØ¯ÛŒÙ†Ú¯ -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="loading-spinner"></div>
        <div id="loadingText">Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±...</div>
    </div>
    
    <!-- Ù¾ÛŒØ§Ù… Ø®Ø·Ø§ -->
    <div class="error-message" id="errorMessage">
        Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±. Ù„Ø·ÙØ§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.
    </div>

    <script>
        // ==================== ØªÙ†Ø¸ÛŒÙ…Ø§Øª ====================
        const JSONBIN_ID = '6984ae3a43b1c97be967c32b';
        const JSONBIN_KEY = '$2a$10$P2f/7ECPzq3HSI.6DSdcr.MaV748WQF7smMQL1bczP6YF4XKwjNvG';
        const JSONBIN_URL = `https://api.jsonbin.io/v3/b/${JSONBIN_ID}`;
        
        // ==================== Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø³Ø±Ø§Ø³Ø±ÛŒ ====================
        let lobbies = [];
        let currentLobby = null;
        let userLiked = false;
        let userDisliked = false;
        let userMicOn = false;
        let currentAvatar = 'avatar1';
        let userName = 'Ø¨Ø§Ø²ÛŒÚ©Ù†';
        let playerStates = {};
        let likeTimeouts = {};
        let currentUser = null;
        let currentSeat = null;
        let isCreator = false;
        let chatMessages = [];
        let lobbyPollingInterval = null;
        
        // ==================== Ø³ÛŒØ³ØªÙ… Ú©Ø§Ø±Ø¨Ø± ====================
        // ØªÙˆÙ„ÛŒØ¯ ÛŒÚ© ID Ù…Ù†Ø­ØµØ± Ø¨Ù‡ ÙØ±Ø¯ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±
        function generateUserId() {
            return 'user_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();
        }
        
        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± Ø§Ø² localStorage
        function loadUserData() {
            const savedAvatar = localStorage.getItem('mafiaUserAvatar');
            const savedName = localStorage.getItem('mafiaUserName');
            const savedUserId = localStorage.getItem('mafiaUserId');
            
            if (savedAvatar) currentAvatar = savedAvatar;
            if (savedName) userName = savedName;
            if (!savedUserId) {
                const newUserId = generateUserId();
                localStorage.setItem('mafiaUserId', newUserId);
                currentUser = newUserId;
            } else {
                currentUser = savedUserId;
            }
            
            updateMainProfile();
        }
        
        // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø§ØµÙ„ÛŒ
        function updateMainProfile() {
            const profileAvatar = document.getElementById('mainProfileAvatar');
            const profileName = document.getElementById('mainProfileName');
            
            profileAvatar.innerHTML = '';
            const avatarImg = document.createElement('img');
            avatarImg.src = currentAvatar === 'avatar1' 
                ? 'https://s8.uupload.ir/files/inshot_20260208_214035107_wkwk.png'
                : 'https://s8.uupload.ir/files/inshot_20260208_214116629_6joe.png';
            avatarImg.alt = 'Ø¢ÙˆØ§ØªØ§Ø± Ú©Ø§Ø±Ø¨Ø±';
            profileAvatar.appendChild(avatarImg);
            profileName.textContent = userName;
        }
        
        // ==================== Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ± JSONBin ====================
        async function fetchLobbiesFromServer() {
            try {
                showLoading('Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ù„Ø§Ø¨ÛŒâ€ŒÙ‡Ø§...');
                const response = await fetch(`${JSONBIN_URL}/latest`, {
                    headers: {
                        'X-Master-Key': JSONBIN_KEY,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (!response.ok) throw new Error('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§');
                
                const data = await response.json();
                hideLoading();
                return data.record?.lobbies || [];
            } catch (error) {
                hideLoading();
                showError('Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±');
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù„Ø§Ø¨ÛŒâ€ŒÙ‡Ø§:', error);
                return [];
            }
        }
        
        async function updateLobbiesOnServer() {
            try {
                const response = await fetch(JSONBIN_URL, {
                    method: 'PUT',
                    headers: {
                        'X-Master-Key': JSONBIN_KEY,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ lobbies })
                });
                
                if (!response.ok) throw new Error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§');
                
                const data = await response.json();
                return data.record?.lobbies;
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„Ø§Ø¨ÛŒâ€ŒÙ‡Ø§:', error);
                return null;
            }
        }
        
        async function updateLobbyOnServer(lobby) {
            try {
                // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ù„Ø§Ø¨ÛŒ Ø¯Ø± Ø¢Ø±Ø§ÛŒÙ‡ Ùˆ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢Ù†
                const index = lobbies.findIndex(l => l.id === lobby.id);
                if (index !== -1) {
                    lobbies[index] = lobby;
                } else {
                    lobbies.push(lobby);
                }
                
                // Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±
                return await updateLobbiesOnServer();
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„Ø§Ø¨ÛŒ:', error);
                return null;
            }
        }
        
        // ==================== Ù…Ø¯ÛŒØ±ÛŒØª Ù„Ø§Ø¨ÛŒâ€ŒÙ‡Ø§ ====================
        // Ø´Ø±ÙˆØ¹ polling Ø¨Ø±Ø§ÛŒ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙˆØ¶Ø¹ÛŒØª Ù„Ø§Ø¨ÛŒ
        function startLobbyPolling() {
            if (lobbyPollingInterval) clearInterval(lobbyPollingInterval);
            
            lobbyPollingInterval = setInterval(async () => {
                if (!currentLobby) return;
                
                try {
                    // Ø¯Ø±ÛŒØ§ÙØª Ù„Ø§Ø¨ÛŒâ€ŒÙ‡Ø§ Ø§Ø² Ø³Ø±ÙˆØ±
                    const serverLobbies = await fetchLobbiesFromServer();
                    const updatedLobby = serverLobbies.find(l => l.id === currentLobby.id);
                    
                    if (updatedLobby) {
                        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙˆØ¶Ø¹ÛŒØª Ù„Ø§Ø¨ÛŒ
                        currentLobby = updatedLobby;
                        playerStates = updatedLobby.playerStates || {};
                        
                        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´
                        updateLobbyDisplay();
                        
                        // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ú†Øª
                        if (updatedLobby.chat && updatedLobby.chat.length > chatMessages.length) {
                            const newMessages = updatedLobby.chat.slice(chatMessages.length);
                            newMessages.forEach(message => {
                                addChatMessage(message.sender, message.text, message.type);
                            });
                            chatMessages = updatedLobby.chat;
                        }
                    }
                } catch (error) {
                    console.error('Ø®Ø·Ø§ Ø¯Ø± polling Ù„Ø§Ø¨ÛŒ:', error);
                }
            }, 2000); // Ù‡Ø± 2 Ø«Ø§Ù†ÛŒÙ‡ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ
        }
        
        // ØªÙˆÙ‚Ù polling
        function stopLobbyPolling() {
            if (lobbyPollingInterval) {
                clearInterval(lobbyPollingInterval);
                lobbyPollingInterval = null;
            }
        }
        
        // Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† ØµÙØ­Ù‡ ØªØ§Ù„Ø§Ø± Ø¯ÙˆØ³ØªØ§Ù†Ù‡
        async function openFriendlyHall() {
            document.getElementById('main-game-page').style.display = 'none';
            document.getElementById('friendly-hall-page').style.display = 'block';
            
            // Ø¯Ø±ÛŒØ§ÙØª Ù„Ø§Ø¨ÛŒâ€ŒÙ‡Ø§ Ø§Ø² Ø³Ø±ÙˆØ±
            lobbies = await fetchLobbiesFromServer();
            updateLobbiesList();
        }
        
        // Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ Ø¨Ø§Ø²ÛŒ
        function goBackToGame() {
            document.getElementById('friendly-hall-page').style.display = 'none';
            document.getElementById('main-game-page').style.display = 'block';
        }
        
        // Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù…Ù†ÙˆÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ø¨ÛŒ
        function openLobbyModal() {
            document.getElementById('lobbyModal').style.display = 'block';
        }
        
        // Ø¨Ø³ØªÙ† Ù…Ù†ÙˆÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ø¨ÛŒ
        function closeLobbyModal() {
            document.getElementById('lobbyModal').style.display = 'none';
            document.getElementById('lobbyForm').reset();
            document.getElementById('passwordGroup').style.display = 'none';
        }
        
        // Ù†Ù…Ø§ÛŒØ´/Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ÙÛŒÙ„Ø¯ Ø±Ù…Ø²
        function togglePasswordField() {
            const passwordGroup = document.getElementById('passwordGroup');
            const hasPassword = document.getElementById('hasPassword').checked;
            passwordGroup.style.display = hasPassword ? 'flex' : 'none';
        }
        
        // Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ø¨ÛŒ Ø¬Ø¯ÛŒØ¯
        async function createLobby() {
            const lobbyName = document.getElementById('lobbyName').value;
            const hasPassword = document.getElementById('hasPassword').checked;
            const lobbyPassword = document.getElementById('lobbyPassword').value;
            
            if (!lobbyName) {
                alert('Ù„Ø·ÙØ§ Ø§Ø³Ù… Ù„Ø§Ø¨ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            // Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ø¨ÛŒ Ø¬Ø¯ÛŒØ¯
            const newLobby = {
                id: Date.now().toString(),
                name: lobbyName,
                hasPassword: hasPassword,
                password: lobbyPassword,
                role: 'ØªÚ©Ø§ÙˆØ±',
                capacity: 10,
                players: 1,
                maxPlayers: 10,
                creator: currentUser,
                creatorName: userName,
                creatorAvatar: currentAvatar,
                playerStates: {
                    1: {
                        userId: currentUser,
                        name: userName,
                        avatar: currentAvatar,
                        like: false,
                        dislike: false,
                        mic: false,
                        online: true,
                        seat: 1
                    }
                },
                chat: [],
                createdAt: new Date().toISOString(),
                lastActivity: new Date().toISOString()
            };
            
            showLoading('Ø¯Ø± Ø­Ø§Ù„ Ø§ÛŒØ¬Ø§Ø¯ Ù„Ø§Ø¨ÛŒ...');
            
            // Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø¢Ø±Ø§ÛŒÙ‡ Ù…Ø­Ù„ÛŒ
            lobbies.push(newLobby);
            
            // Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±
            await updateLobbiesOnServer();
            
            hideLoading();
            
            // Ø¨Ø³ØªÙ† Ù…Ù†Ùˆ
            closeLobbyModal();
            
            // ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ù„Ø§Ø¨ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯Ù‡
            enterLobby(newLobby.id);
        }
        
        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„ÛŒØ³Øª Ù„Ø§Ø¨ÛŒâ€ŒÙ‡Ø§ Ø¯Ø± ØªØ§Ù„Ø§Ø± Ø¯ÙˆØ³ØªØ§Ù†Ù‡
        function updateLobbiesList() {
            const container = document.getElementById('lobbies-container');
            
            if (lobbies.length === 0) {
                container.innerHTML = '<div class="empty-state">Ù‡ÛŒÚ† Ù„Ø§Ø¨ÛŒâ€ŒØ§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª<br>Ø§ÙˆÙ„ÛŒÙ† Ù„Ø§Ø¨ÛŒ Ø±Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ù†ÛŒØ¯!</div>';
                container.style.display = 'block';
                return;
            }
            
            let html = '';
            lobbies.forEach(lobby => {
                if (!lobby.playerStates) return;
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† Ø¢Ù†Ù„Ø§ÛŒÙ†
                const onlinePlayers = Object.values(lobby.playerStates).filter(p => p.online).length;
                
                html += `
                    <div class="lobby-card" onclick="enterLobby('${lobby.id}')">
                        <div class="lobby-info">
                            <div class="lobby-name">${lobby.name}</div>
                            <div class="lobby-details">
                                Ø³Ø§Ø²Ù†Ø¯Ù‡: ${lobby.creatorName || 'Ù†Ø§Ù…Ø´Ø®Øµ'} | 
                                Ù†Ù‚Ø´: ${lobby.role} | 
                                <span class="lobby-players">${onlinePlayers}/${lobby.maxPlayers}</span> Ù†ÙØ±
                                ${lobby.hasPassword ? ' | ğŸ” Ø±Ù…Ø²Ø¯Ø§Ø±' : ''}
                            </div>
                        </div>
                        <button class="join-button" onclick="enterLobby('${lobby.id}'); event.stopPropagation();">
                            ÙˆØ±ÙˆØ¯
                        </button>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            container.style.display = 'block';
        }
        
        // ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ù„Ø§Ø¨ÛŒ
        async function enterLobby(lobbyId) {
            const lobby = lobbies.find(l => l.id == lobbyId);
            if (!lobby) return;
            
            // Ø§Ú¯Ø± Ù„Ø§Ø¨ÛŒ Ø±Ù…Ø²Ø¯Ø§Ø± Ø§Ø³Øª
            if (lobby.hasPassword && lobby.password) {
                const password = prompt('Ù„Ø·ÙØ§ Ø±Ù…Ø² Ù„Ø§Ø¨ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:');
                if (password !== lobby.password) {
                    alert('Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª!');
                    return;
                }
            }
            
            // Ø¨Ø±Ø±Ø³ÛŒ Ø¸Ø±ÙÛŒØª Ù„Ø§Ø¨ÛŒ
            const onlinePlayers = Object.values(lobby.playerStates).filter(p => p.online).length;
            if (onlinePlayers >= lobby.maxPlayers) {
                alert('Ù„Ø§Ø¨ÛŒ Ù¾Ø± Ø§Ø³Øª!');
                return;
            }
            
            showLoading('Ø¯Ø± Ø­Ø§Ù„ ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ù„Ø§Ø¨ÛŒ...');
            
            // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ø¬Ø§ÛŒÚ¯Ø§Ù‡ Ø®Ø§Ù„ÛŒ
            let seatNumber = 1;
            for (let i = 1; i <= lobby.maxPlayers; i++) {
                if (!lobby.playerStates[i] || !lobby.playerStates[i].online) {
                    seatNumber = i;
                    break;
                }
            }
            
            // Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±
            currentSeat = seatNumber;
            isCreator = (lobby.creator === currentUser);
            
            // Ø§ÛŒØ¬Ø§Ø¯ ÛŒØ§ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒÚ©Ù†
            lobby.playerStates[seatNumber] = {
                userId: currentUser,
                name: userName,
                avatar: currentAvatar,
                like: false,
                dislike: false,
                mic: false,
                online: true,
                seat: seatNumber
            };
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† Ø¢Ù†Ù„Ø§ÛŒÙ†
            lobby.players = Object.values(lobby.playerStates).filter(p => p.online).length;
            lobby.lastActivity = new Date().toISOString();
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø± Ø³Ø±ÙˆØ±
            await updateLobbyOnServer(lobby);
            
            hideLoading();
            
            // ØªÙ†Ø¸ÛŒÙ… Ù„Ø§Ø¨ÛŒ Ø¬Ø§Ø±ÛŒ
            currentLobby = lobby;
            playerStates = lobby.playerStates || {};
            
            // Ù†Ù…Ø§ÛŒØ´ ØµÙØ­Ù‡ Ù„Ø§Ø¨ÛŒ
            document.getElementById('friendly-hall-page').style.display = 'none';
            document.getElementById('lobby-page').style.display = 'block';
            
            // ØªÙ†Ø¸ÛŒÙ… Ø¹Ù†ÙˆØ§Ù† Ù„Ø§Ø¨ÛŒ
            document.getElementById('lobbyTitle').textContent = `${lobby.name} (${lobby.players}/${lobby.maxPlayers})`;
            
            // Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ø§ÛŒØ±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù†
            createPlayerCircles();
            
            // Ø´Ø±ÙˆØ¹ polling Ø¨Ø±Ø§ÛŒ Ù„Ø§Ø¨ÛŒ
            startLobbyPolling();
            
            // Ù†Ù…Ø§ÛŒØ´ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†
            showPlayerJoinedNotification(`${userName} ÙˆØ§Ø±Ø¯ Ù„Ø§Ø¨ÛŒ Ø´Ø¯`);
            
            // Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø®ÙˆØ´â€ŒØ¢Ù…Ø¯
            sendSystemMessage(`${userName} Ø¨Ù‡ Ù„Ø§Ø¨ÛŒ Ù¾ÛŒÙˆØ³Øª`);
            
            console.log(`ğŸšª ÙˆØ§Ø±Ø¯ Ù„Ø§Ø¨ÛŒ Ø´Ø¯ÛŒØ¯: ${lobby.name}`);
        }
        
        // Ù†Ù…Ø§ÛŒØ´ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† ÙˆØ±ÙˆØ¯ Ú©Ø§Ø±Ø¨Ø±
        function showPlayerJoinedNotification(message) {
            const notification = document.getElementById('playerJoinedNotification');
            notification.textContent = message;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }
        
        // Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ø§ÛŒØ±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù†
        function createPlayerCircles() {
            const container = document.getElementById('playersGrid');
            if (!container || !currentLobby) return;
            
            let html = '';
            const maxPlayers = currentLobby.maxPlayers || 10;
            
            for (let i = 1; i <= maxPlayers; i++) {
                const playerData = playerStates[i];
                
                if (playerData && playerData.online) {
                    // Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¢Ù†Ù„Ø§ÛŒÙ†
                    let iconsHtml = '';
                    if (playerData.like) {
                        iconsHtml += '<div class="player-icon like-icon">ğŸ‘</div>';
                    }
                    if (playerData.dislike) {
                        iconsHtml += '<div class="player-icon dislike-icon">ğŸ‘</div>';
                    }
                    
                    // Ù†Ø´Ø§Ù†â€ŒÚ¯Ø± Ø³Ø§Ø²Ù†Ø¯Ù‡
                    const isPlayerCreator = (currentLobby.creator === playerData.userId);
                    
                    html += `
                        <div class="player-circle" data-player="${i}">
                            ${isPlayerCreator ? '<div class="creator-badge">Ø³Ø§Ø²Ù†Ø¯Ù‡</div>' : ''}
                            <div class="player-number">${i}</div>
                            <div class="online-status"></div>
                            ${iconsHtml ? `<div class="player-icons">${iconsHtml}</div>` : ''}
                            ${playerData.mic ? '<div class="player-mic-status">ğŸ¤</div>' : ''}
                            <div class="player-avatar">
                                <img src="${playerData.avatar === 'avatar1' 
                                    ? 'https://s8.uupload.ir/files/inshot_20260208_214035107_wkwk.png'
                                    : 'https://s8.uupload.ir/files/inshot_20260208_214116629_6joe.png'}" 
                                    alt="Ø¢ÙˆØ§ØªØ§Ø± ${playerData.name}">
                            </div>
                            <div class="player-name">
                                ${playerData.name}
                                ${playerData.userId === currentUser ? ' (Ø´Ù…Ø§)' : ''}
                            </div>
                        </div>
                    `;
                } else {
                    // Ø¬Ø§ÛŒÚ¯Ø§Ù‡ Ø®Ø§Ù„ÛŒ
                    html += `
                        <div class="player-circle" data-player="${i}">
                            <div class="player-number">${i}</div>
                            <div class="player-avatar">
                                <div class="empty-avatar">+</div>
                            </div>
                            <div class="player-name">Ø®Ø§Ù„ÛŒ</div>
                        </div>
                    `;
                }
            }
            
            container.innerHTML = html;
        }
        
        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù„Ø§Ø¨ÛŒ
        function updateLobbyDisplay() {
            if (!currentLobby) return;
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¹Ù†ÙˆØ§Ù†
            document.getElementById('lobbyTitle').textContent = 
                `${currentLobby.name} (${currentLobby.players}/${currentLobby.maxPlayers})`;
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø§ÛŒØ±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù†
            createPlayerCircles();
        }
        
        // Ø®Ø±ÙˆØ¬ Ø§Ø² Ù„Ø§Ø¨ÛŒ
        async function closeLobby() {
            if (!currentLobby || !currentSeat) return;
            
            showLoading('Ø¯Ø± Ø­Ø§Ù„ Ø®Ø±ÙˆØ¬ Ø§Ø² Ù„Ø§Ø¨ÛŒ...');
            
            // Ø§Ú¯Ø± Ø³Ø§Ø²Ù†Ø¯Ù‡ Ø§Ø² Ù„Ø§Ø¨ÛŒ Ø®Ø§Ø±Ø¬ Ø´ÙˆØ¯
            if (isCreator) {
                // Ø§Ù†ØªÙ‚Ø§Ù„ Ø³Ø§Ø²Ù†Ø¯Ú¯ÛŒ Ø¨Ù‡ ÛŒÚ© Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¯ÛŒÚ¯Ø±
                const otherPlayers = Object.values(playerStates).filter(p => 
                    p.online && p.userId !== currentUser
                );
                
                if (otherPlayers.length > 0) {
                    // Ø§ÙˆÙ„ÛŒÙ† Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¢Ù†Ù„Ø§ÛŒÙ† Ø¯ÛŒÚ¯Ø± Ø±Ø§ Ø³Ø§Ø²Ù†Ø¯Ù‡ Ú©Ù†
                    const newCreator = otherPlayers[0];
                    currentLobby.creator = newCreator.userId;
                    currentLobby.creatorName = newCreator.name;
                    currentLobby.creatorAvatar = newCreator.avatar;
                    
                    sendSystemMessage(`${newCreator.name} Ø³Ø§Ø²Ù†Ø¯Ù‡ Ø¬Ø¯ÛŒØ¯ Ù„Ø§Ø¨ÛŒ Ø´Ø¯`);
                } else {
                    // Ø§Ú¯Ø± Ù‡ÛŒÚ† Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¯ÛŒÚ¯Ø±ÛŒ Ù†ÛŒØ³ØªØŒ Ù„Ø§Ø¨ÛŒ Ø±Ø§ Ø­Ø°Ù Ú©Ù†
                    await deleteLobby();
                    hideLoading();
                    stopLobbyPolling();
                    document.getElementById('lobby-page').style.display = 'none';
                    document.getElementById('friendly-hall-page').style.display = 'block';
                    updateLobbiesList();
                    return;
                }
            }
            
            // Ø­Ø°Ù Ú©Ø§Ø±Ø¨Ø± Ø§Ø² Ù„Ø§Ø¨ÛŒ
            delete playerStates[currentSeat];
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù†
            currentLobby.players = Object.values(playerStates).filter(p => p.online).length;
            currentLobby.lastActivity = new Date().toISOString();
            
            // Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø®Ø±ÙˆØ¬
            sendSystemMessage(`${userName} Ø§Ø² Ù„Ø§Ø¨ÛŒ Ø®Ø§Ø±Ø¬ Ø´Ø¯`);
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø± Ø³Ø±ÙˆØ±
            await updateLobbyOnServer(currentLobby);
            
            hideLoading();
            
            // ØªÙˆÙ‚Ù polling
            stopLobbyPolling();
            
            // Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ ØªØ§Ù„Ø§Ø±
            document.getElementById('lobby-page').style.display = 'none';
            document.getElementById('friendly-hall-page').style.display = 'block';
            updateLobbiesList();
            
            // Ø±ÛŒØ³Øª Ù…ØªØºÛŒØ±Ù‡Ø§
            currentLobby = null;
            currentSeat = null;
            isCreator = false;
            playerStates = {};
        }
        
        // Ø­Ø°Ù Ù„Ø§Ø¨ÛŒ
        async function deleteLobby() {
            if (!currentLobby) return;
            
            // Ø­Ø°Ù Ù„Ø§Ø¨ÛŒ Ø§Ø² Ø¢Ø±Ø§ÛŒÙ‡
            const index = lobbies.findIndex(l => l.id === currentLobby.id);
            if (index !== -1) {
                lobbies.splice(index, 1);
                await updateLobbiesOnServer();
            }
        }
        
        // Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ
        async function startGame() {
            if (!currentLobby || !isCreator) {
                alert('ÙÙ‚Ø· Ø³Ø§Ø²Ù†Ø¯Ù‡ Ù„Ø§Ø¨ÛŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø¨Ø§Ø²ÛŒ Ø±Ø§ Ø´Ø±ÙˆØ¹ Ú©Ù†Ø¯!');
                return;
            }
            
            if (currentLobby.players < 4) {
                alert('Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ Ø­Ø¯Ø§Ù‚Ù„ Û´ Ø¨Ø§Ø²ÛŒÚ©Ù† Ù„Ø§Ø²Ù… Ø§Ø³Øª!');
                return;
            }
            
            showLoading('Ø¯Ø± Ø­Ø§Ù„ Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ...');
            
            // Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ
            sendSystemMessage('Ø¨Ø§Ø²ÛŒ Ø¯Ø± Ø­Ø§Ù„ Ø´Ø±ÙˆØ¹ Ø§Ø³Øª...');
            
            setTimeout(() => {
                hideLoading();
                alert('ğŸ® Ø¨Ø§Ø²ÛŒ Ø´Ø±ÙˆØ¹ Ø´Ø¯!');
                console.log('ğŸ® Ø¨Ø§Ø²ÛŒ Ø´Ø±ÙˆØ¹ Ø´Ø¯!');
            }, 2000);
        }
        
        // ==================== Ø³ÛŒØ³ØªÙ… Ú†Øª ====================
        function toggleChat() {
            const chatContainer = document.getElementById('chatContainer');
            chatContainer.style.display = chatContainer.style.display === 'flex' ? 'none' : 'flex';
        }
        
        async function sendChatMessage() {
            const chatInput = document.getElementById('chatInput');
            const message = chatInput.value.trim();
            
            if (!message || !currentLobby) return;
            
            // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ú†Øª
            const chatMessage = {
                sender: userName,
                senderId: currentUser,
                text: message,
                type: 'user',
                timestamp: new Date().toISOString()
            };
            
            // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ø¢Ø±Ø§ÛŒÙ‡ Ù…Ø­Ù„ÛŒ
            if (!currentLobby.chat) currentLobby.chat = [];
            currentLobby.chat.push(chatMessage);
            chatMessages = currentLobby.chat;
            
            // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù…
            addChatMessage(userName, message, 'sent');
            
            // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙÛŒÙ„Ø¯ ÙˆØ±ÙˆØ¯ÛŒ
            chatInput.value = '';
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø± Ø³Ø±ÙˆØ±
            await updateLobbyOnServer(currentLobby);
        }
        
        function sendSystemMessage(text) {
            if (!currentLobby) return;
            
            const systemMessage = {
                sender: 'Ø³ÛŒØ³ØªÙ…',
                text: text,
                type: 'system',
                timestamp: new Date().toISOString()
            };
            
            if (!currentLobby.chat) currentLobby.chat = [];
            currentLobby.chat.push(systemMessage);
            chatMessages = currentLobby.chat;
            
            // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù…
            addChatMessage('Ø³ÛŒØ³ØªÙ…', text, 'system');
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø± Ø³Ø±ÙˆØ±
            updateLobbyOnServer(currentLobby);
        }
        
        function addChatMessage(sender, text, type) {
            const chatMessagesContainer = document.getElementById('chatMessages');
            if (!chatMessagesContainer) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type === 'sent' ? 'sent' : 'received'}`;
            
            let senderText = sender;
            if (type === 'system') {
                senderText = 'ğŸ“¢ ' + sender;
            } else if (type === 'sent') {
                senderText = 'ğŸ‘¤ ' + sender + ' (Ø´Ù…Ø§)';
            } else {
                senderText = 'ğŸ‘¤ ' + sender;
            }
            
            messageDiv.innerHTML = `
                <div class="message-sender">${senderText}</div>
                <div class="message-text">${text}</div>
            `;
            
            chatMessagesContainer.appendChild(messageDiv);
            
            // Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ù‡ Ù¾Ø§ÛŒÛŒÙ†
            chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;
        }
        
        // ==================== Ø³ÛŒØ³ØªÙ… Ù„Ø§ÛŒÚ©/Ø¯ÛŒØ³Ù„Ø§ÛŒÚ©/Ù…ÛŒÚ©Ø±ÙˆÙÙˆÙ† ====================
        async function toggleLike() {
            if (!currentLobby || !currentSeat) return;
            
            const playerData = playerStates[currentSeat];
            if (!playerData) return;
            
            playerData.like = !playerData.like;
            playerData.dislike = false;
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´
            createPlayerCircles();
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø± Ø³Ø±ÙˆØ±
            await updateLobbyOnServer(currentLobby);
            
            // Ø­Ø°Ù Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ø¹Ø¯ Ø§Ø² 3 Ø«Ø§Ù†ÛŒÙ‡
            if (playerData.like) {
                setTimeout(async () => {
                    if (playerStates[currentSeat] && playerStates[currentSeat].like) {
                        playerStates[currentSeat].like = false;
                        createPlayerCircles();
                        await updateLobbyOnServer(currentLobby);
                    }
                }, 3000);
            }
        }
        
        async function toggleDislike() {
            if (!currentLobby || !currentSeat) return;
            
            const playerData = playerStates[currentSeat];
            if (!playerData) return;
            
            playerData.dislike = !playerData.dislike;
            playerData.like = false;
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´
            createPlayerCircles();
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø± Ø³Ø±ÙˆØ±
            await updateLobbyOnServer(currentLobby);
            
            // Ø­Ø°Ù Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ø¹Ø¯ Ø§Ø² 3 Ø«Ø§Ù†ÛŒÙ‡
            if (playerData.dislike) {
                setTimeout(async () => {
                    if (playerStates[currentSeat] && playerStates[currentSeat].dislike) {
                        playerStates[currentSeat].dislike = false;
                        createPlayerCircles();
                        await updateLobbyOnServer(currentLobby);
                    }
                }, 3000);
            }
        }
        
        async function toggleMic() {
            if (!currentLobby || !currentSeat) return;
            
            const playerData = playerStates[currentSeat];
            if (!playerData) return;
            
            playerData.mic = !playerData.mic;
            userMicOn = playerData.mic;
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ú©Ù…Ù‡ Ù…ÛŒÚ©Ø±ÙˆÙÙˆÙ†
            const micBtn = document.getElementById('micButton');
            if (userMicOn) {
                micBtn.classList.add('active');
                sendSystemMessage(`${userName} Ù…ÛŒÚ©Ø±ÙˆÙÙˆÙ† Ø±Ø§ Ø±ÙˆØ´Ù† Ú©Ø±Ø¯`);
            } else {
                micBtn.classList.remove('active');
                sendSystemMessage(`${userName} Ù…ÛŒÚ©Ø±ÙˆÙÙˆÙ† Ø±Ø§ Ø®Ø§Ù…ÙˆØ´ Ú©Ø±Ø¯`);
            }
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´
            createPlayerCircles();
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø± Ø³Ø±ÙˆØ±
            await updateLobbyOnServer(currentLobby);
        }
        
        // ==================== Ø³ÛŒØ³ØªÙ… Ù¾Ø±ÙˆÙØ§ÛŒÙ„ ====================
        function openProfileModal() {
            document.getElementById('profileModal').style.display = 'block';
            document.getElementById('avatar1').classList.remove('selected');
            document.getElementById('avatar2').classList.remove('selected');
            document.getElementById(currentAvatar).classList.add('selected');
            document.getElementById('currentUserName').textContent = userName;
            document.getElementById('userNameInput').value = '';
        }
        
        function closeProfileModal() {
            document.getElementById('profileModal').style.display = 'none';
        }
        
        function switchProfileTab(tabName) {
            document.querySelectorAll('.profile-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.profile-tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            if (tabName === 'avatars') {
                document.querySelector('.profile-tab:nth-child(1)').classList.add('active');
                document.getElementById('avatarsTab').classList.add('active');
            } else {
                document.querySelector('.profile-tab:nth-child(2)').classList.add('active');
                document.getElementById('buyTab').classList.add('active');
            }
        }
        
        function selectAvatar(avatarId) {
            document.getElementById('avatar1').classList.remove('selected');
            document.getElementById('avatar2').classList.remove('selected');
            document.getElementById(avatarId).classList.add('selected');
            currentAvatar = avatarId;
            localStorage.setItem('mafiaUserAvatar', currentAvatar);
            updateMainProfile();
            
            // Ø§Ú¯Ø± Ø¯Ø± Ù„Ø§Ø¨ÛŒ Ù‡Ø³ØªÛŒÙ…ØŒ Ø¢ÙˆØ§ØªØ§Ø± Ø±Ø§ Ø¨Ù‡â€ŒØ±ÙˆØ² Ú©Ù†
            if (currentLobby && currentSeat && playerStates[currentSeat]) {
                playerStates[currentSeat].avatar = currentAvatar;
                updateLobbyOnServer(currentLobby);
                createPlayerCircles();
            }
        }
        
        function saveUserName() {
            const newName = document.getElementById('userNameInput').value.trim();
            
            if (!newName) {
                alert('Ù„Ø·ÙØ§ Ù†Ø§Ù… Ø¬Ø¯ÛŒØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            if (newName.length < 2 || newName.length > 20) {
                alert('Ù†Ø§Ù… Ø¨Ø§ÛŒØ¯ Ø¨ÛŒÙ† Û² ØªØ§ Û²Û° Ø­Ø±Ù Ø¨Ø§Ø´Ø¯');
                return;
            }
            
            userName = newName;
            localStorage.setItem('mafiaUserName', userName);
            updateMainProfile();
            document.getElementById('currentUserName').textContent = userName;
            
            // Ø§Ú¯Ø± Ø¯Ø± Ù„Ø§Ø¨ÛŒ Ù‡Ø³ØªÛŒÙ…ØŒ Ù†Ø§Ù… Ø±Ø§ Ø¨Ù‡â€ŒØ±ÙˆØ² Ú©Ù†
            if (currentLobby && currentSeat && playerStates[currentSeat]) {
                playerStates[currentSeat].name = userName;
                updateLobbyOnServer(currentLobby);
                createPlayerCircles();
            }
        }
        
        // ==================== Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ú©Ù…Ú©ÛŒ ====================
        function showLoading(text) {
            const overlay = document.getElementById('loadingOverlay');
            const loadingText = document.getElementById('loadingText');
            loadingText.textContent = text || 'Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...';
            overlay.style.display = 'flex';
        }
        
        function hideLoading() {
            document.getElementById('loadingOverlay').style.display = 'none';
        }
        
        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }
        
        // ==================== Ù…Ø¯ÛŒØ±ÛŒØª Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ ====================
        window.onclick = function(event) {
            const profileModal = document.getElementById('profileModal');
            if (event.target === profileModal) {
                profileModal.style.display = 'none';
            }
            
            const lobbyModal = document.getElementById('lobbyModal');
            if (event.target === lobbyModal) {
                lobbyModal.style.display = 'none';
            }
        };
        
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                if (document.getElementById('profileModal').style.display === 'block') {
                    closeProfileModal();
                } else if (document.getElementById('lobbyModal').style.display === 'block') {
                    closeLobbyModal();
                } else if (document.getElementById('lobby-page').style.display === 'block') {
                    closeLobby();
                } else if (document.getElementById('friendly-hall-page').style.display === 'block') {
                    goBackToGame();
                }
            }
            
            // Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø¨Ø§ Enter
            if (e.key === 'Enter' && document.getElementById('chatInput') && 
                document.activeElement === document.getElementById('chatInput')) {
                sendChatMessage();
            }
        });
        
        document.getElementById('lobbyForm').addEventListener('submit', function(e) {
            e.preventDefault();
        });
        
        // ==================== Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ ====================
        window.onload = async function() {
            loadUserData();
            
            // Ø§ØªØµØ§Ù„ Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ù‡ Ø³Ø±ÙˆØ±
            showLoading('Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±...');
            lobbies = await fetchLobbiesFromServer();
            hideLoading();
            
            // Ø§Ú¯Ø± Ù„Ø§Ø¨ÛŒâ€ŒØ§ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø´ØªØŒ ÛŒÚ© Ù„Ø§Ø¨ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†
            if (lobbies.length === 0) {
                const sampleLobby = {
                    id: 'sample_' + Date.now(),
                    name: 'Ù„Ø§Ø¨ÛŒ Ù†Ù…ÙˆÙ†Ù‡',
                    hasPassword: false,
                    role: 'ØªÚ©Ø§ÙˆØ±',
                    capacity: 10,
                    players: 3,
                    maxPlayers: 10,
                    creator: 'sample_creator',
                    creatorName: 'Ø§Ø¯Ù…ÛŒÙ†',
                    creatorAvatar: 'avatar1',
                    playerStates: {
                        1: {
                            userId: 'sample_creator',
                            name: 'Ø§Ø¯Ù…ÛŒÙ†',
                            avatar: 'avatar1',
                            like: true,
                            dislike: false,
                            mic: true,
                            online: true,
                            seat: 1
                        },
                        2: {
                            userId: 'sample_user2',
                            name: 'Ø³Ø§Ø±Ø§',
                            avatar: 'avatar2',
                            like: false,
                            dislike: true,
                            mic: false,
                            online: true,
                            seat: 2
                        },
                        3: {
                            userId: 'sample_user3',
                            name: 'Ø¹Ù„ÛŒ',
                            avatar: 'avatar1',
                            like: true,
                            dislike: false,
                            mic: true,
                            online: true,
                            seat: 3
                        }
                    },
                    chat: [
                        {
                            sender: 'Ø³ÛŒØ³ØªÙ…',
                            text: 'Ø¨Ù‡ Ù„Ø§Ø¨ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯!',
                            type: 'system',
                            timestamp: new Date().toISOString()
                        }
                    ],
                    createdAt: new Date().toISOString(),
                    lastActivity: new Date().toISOString()
                };
                
                lobbies.push(sampleLobby);
                await updateLobbiesOnServer();
            }
        };
    </script>
</body>
</html>